<!DOCTYPE html>
<html lang="zh-CN">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>å¯ç”¨æ€§æµ‹è¯•æ•°æ®æ”¶é›†ç³»ç»Ÿ</title>
    <style>
        *{margin:0;padding:0;box-sizing:border-box}
        body{font-family:'Segoe UI',Tahoma,Geneva,Verdana,sans-serif;background:linear-gradient(135deg,#ffa366 0%,#87ceeb 100%);min-height:100vh;padding:20px}
        .container{max-width:1400px;margin:0 auto}
        h1{text-align:center;color:#fff;margin-bottom:30px;font-size:2.5em;text-shadow:2px 2px 4px rgba(0,0,0,.3)}
        .tabs{display:flex;gap:10px;margin-bottom:20px;flex-wrap:wrap}
        .tab{background:#fff;padding:12px 30px;border-radius:10px 10px 0 0;cursor:pointer;font-weight:600;transition:all .3s;color:#ff6b35}
        .tab.active{background:rgba(255,255,255,.95);color:#4a90e2}
        .tab-panel{display:none;background:#fff;border-radius:15px;padding:30px;box-shadow:0 10px 30px rgba(0,0,0,.2)}
        .tab-panel.active{display:block}
        .testing-flow{background:#fff;border-radius:15px;padding:30px;margin-bottom:30px;box-shadow:0 10px 30px rgba(0,0,0,.2)}
        .flow-title{font-size:1.5em;color:#ff6b35;margin-bottom:20px;border-bottom:3px solid #ff6b35;padding-bottom:10px}
        .flow-steps{display:flex;justify-content:space-between;align-items:center;flex-wrap:wrap;gap:20px}
        .step{flex:1;min-width:120px;background:linear-gradient(135deg,#ff6b35 0%,#f7931e 100%);color:#fff;padding:15px;border-radius:10px;text-align:center;box-shadow:0 5px 15px rgba(0,0,0,.2);transition:transform .3s}
        .step:hover{transform:translateY(-5px)}
        .step-number{font-size:1.8em;font-weight:700;margin-bottom:8px}
        .step-name{font-size:.95em}
        .arrow{font-size:2em;color:#4a90e2;flex-shrink:0}
        @media (max-width:768px){.flow-steps{flex-direction:column}.arrow{transform:rotate(90deg)}.step{width:100%}}
        .form-section{background:#fff;border-radius:15px;padding:25px;box-shadow:0 10px 30px rgba(0,0,0,.2)}
        .section-title{font-size:1.3em;color:#ff6b35;margin-bottom:20px;border-bottom:2px solid #ff6b35;padding-bottom:10px}
        .form-group{margin-bottom:20px}
        label{display:block;margin-bottom:8px;color:#333;font-weight:600}
        input[type=text],input[type=number],textarea{width:100%;padding:12px;border:2px solid #e0e0e0;border-radius:8px;font-size:1em;transition:border-color .3s}
        input:focus,textarea:focus{outline:0;border-color:#4a90e2}
        textarea{resize:vertical;min-height:80px;font-family:inherit}
        .checkbox-group,.radio-group{display:flex;flex-wrap:wrap;gap:15px;margin-top:10px}
        .checkbox-item,.radio-item{display:flex;align-items:center;gap:8px}
        .checkbox-item input,.radio-item input{width:20px;height:20px;cursor:pointer}
        table{width:100%;border-collapse:collapse;margin-top:15px;font-size:.9em}
        th,td{padding:10px;border-bottom:1px solid #e0e0e0}
        th{background:#4a90e2;color:#fff;font-weight:600}
        tr:hover{background:#f5f5f5}
        table input,table textarea{width:100%;padding:8px;border:1px solid #ddd;border-radius:5px}
        .btn{background:linear-gradient(135deg,#ff6b35 0%,#f7931e 100%);color:#fff;border:0;padding:12px 30px;border-radius:8px;cursor:pointer;font-size:1em;font-weight:600;transition:transform .2s;width:100%}
        .btn:hover{transform:scale(1.05)}
        .btn:active{transform:scale(.95)}
        .btn.secondary{background:linear-gradient(135deg,#e74c3c 0%,#c0392b 100%)}
        .btn.success{background:linear-gradient(135deg,#3498db 0%,#2980b9 100%)}
        .summary-stats{display:grid;grid-template-columns:repeat(auto-fit,minmax(200px,1fr));gap:15px;margin-bottom:20px}
        .stat-card{background:linear-gradient(135deg,#ff6b35 0%,#f7931e 100%);color:#fff;padding:20px;border-radius:10px;text-align:center;box-shadow:0 5px 15px rgba(0,0,0,.2)}
        .data-list{max-height:500px;overflow-y:auto}
        .data-item{background:#f9f9f9;padding:15px;margin-bottom:10px;border-radius:8px;border-left:4px solid #4a90e2}
        .data-item h4{color:#ff6b35;margin-bottom:10px}
        .data-item p{margin:5px 0;color:#666;font-size:.9em}
        .alert{background:#d4edda;color:#155724;padding:15px;border-radius:8px;margin-bottom:20px;border-left:4px solid #28a745}
    </style>
</head>
<body>
    <div class="container">
        <h1>ğŸ§ª å¯ç”¨æ€§æµ‹è¯•æ•°æ®æ”¶é›†ç³»ç»Ÿ</h1>
        
        <div class="testing-flow">
            <h2 class="flow-title">æµ‹è¯•æµç¨‹</h2>
            <div class="flow-steps">
                <div class="step"><div class="step-number">1</div><div class="step-name">å‡†å¤‡</div></div>
                <div class="arrow">â†’</div>
                <div class="step"><div class="step-number">2</div><div class="step-name">åˆ†æ</div></div>
                <div class="arrow">â†’</div>
                <div class="step"><div class="step-number">3</div><div class="step-name">ç¡®è®¤</div></div>
                <div class="arrow">â†’</div>
                <div class="step"><div class="step-number">4</div><div class="step-name">è®¡åˆ’</div></div>
                <div class="arrow">â†’</div>
                <div class="step"><div class="step-number">5</div><div class="step-name">å‡†å¤‡å®æ–½</div></div>
                <div class="arrow">â†’</div>
                <div class="step"><div class="step-number">6</div><div class="step-name">å®æ–½</div></div>
                <div class="arrow">â†’</div>
                <div class="step"><div class="step-number">7</div><div class="step-name">æŠ¥å‘Š</div></div>
            </div>
        </div>

        <div class="tabs">
            <div class="tab active" onclick="showTab('form')">ğŸ“ å¡«å†™è¡¨å•</div>
            <div class="tab" onclick="showTab('summary')">ğŸ“Š æ•°æ®æ±‡æ€»</div>
        </div>

        <!-- å¡«å†™è¡¨å• -->
        <div id="form-tab" class="tab-panel active">
            <div class="form-section">
                <h2 class="section-title">æµ‹è¯•å‰é—®å·</h2>
                <div class="form-group">
                    <label>å‚ä¸è€…å§“å *</label>
                    <input type="text" id="participant-name" placeholder="è¾“å…¥å‚ä¸è€…å§“å" required>
                </div>
                <div class="form-group">
                    <label>æ‚¨ä¹‹å‰æ˜¯å¦ä¸åŸºäºå…‰çš„äº¤äº’è£…ç½®äº’åŠ¨è¿‡ï¼Ÿ</label>
                    <div class="radio-group">
                        <div class="radio-item"><input type="radio" name="light-before" value="yes"><label>æ˜¯</label></div>
                        <div class="radio-item"><input type="radio" name="light-before" value="no"><label>å¦</label></div>
                    </div>
                </div>
                <div class="form-group">
                    <label>åœ¨å…¬å…±äº’åŠ¨ç©ºé—´ä¸­ï¼Œä»€ä¹ˆä¼šå¸å¼•æ‚¨çš„æ³¨æ„åŠ›ï¼Ÿ</label>
                    <div class="checkbox-group">
                        <div class="checkbox-item"><input type="checkbox" value="å…‰"><label>å…‰</label></div>
                        <div class="checkbox-item"><input type="checkbox" value="å£°éŸ³"><label>å£°éŸ³</label></div>
                        <div class="checkbox-item"><input type="checkbox" value="è¿åŠ¨"><label>è¿åŠ¨</label></div>
                        <div class="checkbox-item"><input type="checkbox" value="è§¦æ‘¸"><label>è§¦æ‘¸</label></div>
                        <div class="checkbox-item"><input type="checkbox" value="å…¶ä»–"><label>å…¶ä»–</label></div>
                    </div>
                </div>
                <div class="form-group">
                    <label>ä»€ä¹ˆä¼šè®©æ‚¨æ¥è¿‘å¹¶è§¦æ‘¸ä¸€ä¸ªæœªçŸ¥çš„ç‰©ä½“ï¼Ÿ</label>
                    <textarea id="approach-text"></textarea>
                </div>
            </div>

            <div class="form-section" style="margin-top:20px">
                <h2 class="section-title">ä»»åŠ¡è®°å½•è¡¨</h2>
                <table id="task-table">
                    <thead>
                        <tr>
                            <th style="width:35%">ä»»åŠ¡</th>
                            <th style="width:15%">å®Œæˆæ—¶é—´</th>
                            <th style="width:10%">é”™è¯¯æ•°</th>
                            <th style="width:40%">è§‚å¯Ÿè®°å½•</th>
                        </tr>
                    </thead>
                    <tbody>
                        <tr><td>è·å–å‘¼å¸ä¼ æ„Ÿå™¨å¹¶ç†è§£å…¶ä½¿ç”¨æ–¹å¼</td><td><input type="text" class="task-time"></td><td><input type="number" class="task-error"></td><td><textarea rows="2" class="task-note"></textarea></td></tr>
                        <tr><td>è¿›å…¥Cubeå¹¶å®šä½ç»³ç´¢åŒºåŸŸ</td><td><input type="text" class="task-time"></td><td><input type="number" class="task-error"></td><td><textarea rows="2" class="task-note"></textarea></td></tr>
                        <tr><td>è§¦æ‘¸æ¯›èŒ¸ç‹ç‹¸è£…ç½®å¹¶æ³¨æ„å…¶å£°éŸ³æˆ–æŒ¯åŠ¨åé¦ˆ</td><td><input type="text" class="task-time"></td><td><input type="number" class="task-error"></td><td><textarea rows="2" class="task-note"></textarea></td></tr>
                        <tr><td>ä½¿ç”¨ä¼ æ„Ÿå™¨å¼€å§‹å‘¼å¸å†¥æƒ³</td><td><input type="text" class="task-time"></td><td><input type="number" class="task-error"></td><td><textarea rows="2" class="task-note"></textarea></td></tr>
                        <tr><td>è°ƒæ•´å‘¼å¸ä»¥ä¸è£…ç½®çš„èŠ‚å¥åŒæ­¥</td><td><input type="text" class="task-time"></td><td><input type="number" class="task-error"></td><td><textarea rows="2" class="task-note"></textarea></td></tr>
                    </tbody>
                </table>
            </div>

            <div class="form-section" style="margin-top:20px">
                <h2 class="section-title">æµ‹è¯•åé—®å·</h2>
                <div class="form-group">
                    <label>æ‚¨æ˜¯å¦‚ä½•æ„è¯†åˆ°è¿™æ˜¯ä¸€ä¸ªäº¤äº’è£…ç½®çš„ï¼Ÿ</label>
                    <textarea id="realization-text"></textarea>
                </div>
                <div class="form-group">
                    <label>å¼„æ¸…æ¥šå¦‚ä½•ä¸è£…ç½®äº’åŠ¨çš„éš¾æ˜“ç¨‹åº¦ï¼Ÿ</label>
                    <div class="radio-group">
                        <div class="radio-item"><input type="radio" name="ease" value="éå¸¸å®¹æ˜“"><label>éå¸¸å®¹æ˜“</label></div>
                        <div class="radio-item"><input type="radio" name="ease" value="æœ‰ç‚¹å®¹æ˜“"><label>æœ‰ç‚¹å®¹æ˜“</label></div>
                        <div class="radio-item"><input type="radio" name="ease" value="ä¸­æ€§"><label>ä¸­æ€§</label></div>
                        <div class="radio-item"><input type="radio" name="ease" value="å›°éš¾"><label>å›°éš¾</label></div>
                    </div>
                </div>
                <div class="form-group">
                    <label>å…‰çš„"å¿ƒè·³æ•ˆæœ"æ˜¯å¦è®©æ‚¨æ„Ÿåˆ°æƒ…æ„Ÿæˆ–èº«ä½“ä¸Šçš„æŠ•å…¥ï¼Ÿ</label>
                    <div class="radio-group">
                        <div class="radio-item"><input type="radio" name="engaged" value="yes"><label>æ˜¯</label></div>
                        <div class="radio-item"><input type="radio" name="engaged" value="no"><label>å¦</label></div>
                    </div>
                </div>
                <div class="form-group">
                    <label>è¯·æè¿°æ‚¨çš„æ„Ÿå—ï¼ˆå¦‚æœæ˜¯ï¼‰ï¼š</label>
                    <textarea id="feelings-text"></textarea>
                </div>
                <div class="form-group">
                    <label>æ‚¨æœ€å–œæ¬¢çš„ä½“éªŒéƒ¨åˆ†æ˜¯ä»€ä¹ˆï¼Ÿ</label>
                    <textarea id="favorite-text"></textarea>
                </div>
                <div class="form-group">
                    <label>æ‚¨æœ€ä¸å–œæ¬¢çš„ä½“éªŒéƒ¨åˆ†æ˜¯ä»€ä¹ˆï¼Ÿ</label>
                    <textarea id="least-text"></textarea>
                </div>
                <button class="btn" onclick="submitData()">ğŸ’¾ ä¿å­˜æ•°æ®</button>
                <button class="btn secondary" onclick="clearForm()" style="margin-top:10px">ğŸ—‘ï¸ æ¸…ç©ºè¡¨å•</button>
            </div>
        </div>

        <!-- æ•°æ®æ±‡æ€» -->
        <div id="summary-tab" class="tab-panel">
            <div class="form-section">
                <h2 class="section-title">æ•°æ®æ±‡æ€»ç»Ÿè®¡</h2>
                <div class="summary-stats">
                    <div class="stat-card">
                        <div class="stat-number" id="total-count">0</div>
                        <div class="stat-label">æ€»æµ‹è¯•æ¬¡æ•°</div>
                    </div>
                    <div class="stat-card">
                        <div class="stat-number" id="avg-time">0</div>
                        <div class="stat-label">å¹³å‡å®Œæˆæ—¶é—´</div>
                    </div>
                    <div class="stat-card">
                        <div class="stat-number" id="avg-error">0</div>
                        <div class="stat-label">å¹³å‡é”™è¯¯æ•°</div>
                    </div>
                    <div class="stat-card">
                        <div class="stat-number" id="engaged-rate">0%</div>
                        <div class="stat-label">æƒ…æ„ŸæŠ•å…¥ç‡</div>
                    </div>
                </div>
            </div>

            <div class="form-section" style="margin-top:20px">
                <h2 class="section-title">æ‰€æœ‰æµ‹è¯•è®°å½•</h2>
                <div class="data-list" id="data-list"></div>
                <button class="btn secondary" onclick="clearAllData()" style="margin-top:15px">ğŸ—‘ï¸ æ¸…ç©ºæ‰€æœ‰æ•°æ®</button>
                <button class="btn success" onclick="exportData()" style="margin-top:10px">ğŸ“¥ å¯¼å‡ºæ•°æ®ä¸ºJSON</button>
            </div>
        </div>
    </div>

    <script>
        function showTab(tabName){
            document.querySelectorAll('.tab').forEach(t=>t.classList.remove('active'));
            document.querySelectorAll('.tab-panel').forEach(p=>p.classList.remove('active'));
            event.target.classList.add('active');
            document.getElementById(tabName+'-tab').classList.add('active');
            if(tabName==='summary') updateSummary();
        }

        function submitData(){
            const name=document.getElementById('participant-name').value.trim();
            if(!name){alert('è¯·å…ˆè¾“å…¥å‚ä¸è€…å§“åï¼');return;}
            
            const data={
                name,
                timestamp:new Date().toLocaleString('zh-CN'),
                preTest:{
                    lightBefore:document.querySelector('input[name="light-before"]:checked')?.value||'',
                    attention:Array.from(document.querySelectorAll('input[type="checkbox"]:checked')).map(c=>c.value),
                    approach:document.getElementById('approach-text').value
                },
                tasks:Array.from(document.querySelectorAll('#task-table tbody tr')).map(row=>({
                    task:row.querySelector('td:first-child').textContent,
                    time:row.querySelector('.task-time').value,
                    error:parseInt(row.querySelector('.task-error').value)||0,
                    note:row.querySelector('.task-note').value
                })),
                postTest:{
                    realization:document.getElementById('realization-text').value,
                    ease:document.querySelector('input[name="ease"]:checked')?.value||'',
                    engaged:document.querySelector('input[name="engaged"]:checked')?.value||'',
                    feelings:document.getElementById('feelings-text').value,
                    favorite:document.getElementById('favorite-text').value,
                    least:document.getElementById('least-text').value
                }
            };

            let allData=JSON.parse(localStorage.getItem('testingData')||'[]');
            allData.push(data);
            localStorage.setItem('testingData',JSON.stringify(allData));
            
            alert('æ•°æ®å·²æˆåŠŸä¿å­˜ï¼');
            clearForm();
            updateSummary();
        }

        function clearForm(){
            document.querySelectorAll('input[type="text"],input[type="number"],textarea').forEach(i=>i.value='');
            document.querySelectorAll('input[type="radio"],input[type="checkbox"]').forEach(i=>i.checked=false);
        }

        function updateSummary(){
            const allData=JSON.parse(localStorage.getItem('testingData')||'[]');
            const listContainer=document.getElementById('data-list');
            
            document.getElementById('total-count').textContent=allData.length;
            
            if(allData.length>0){
                const totalTime=allData.reduce((sum,d)=>sum+d.tasks.reduce((s,t)=>s+(parseFloat(t.time)||0),0),0);
                const avgTime=(totalTime/allData.length/5).toFixed(1);
                document.getElementById('avg-time').textContent=avgTime;
                
                const totalError=allData.reduce((sum,d)=>sum+d.tasks.reduce((s,t)=>s+t.error,0),0);
                const avgError=(totalError/allData.length/5).toFixed(1);
                document.getElementById('avg-error').textContent=avgError;
                
                const engaged=allData.filter(d=>d.postTest.engaged==='yes').length;
                document.getElementById('engaged-rate').textContent=Math.round(engaged/allData.length*100)+'%';
                
                listContainer.innerHTML=allData.map((d,i)=>`
                    <div class="data-item">
                        <h4>æµ‹è¯• ${i+1}: ${d.name} - ${d.timestamp}</h4>
                        <p><strong>æµ‹è¯•å‰:</strong> å…‰è£…ç½®ç»éªŒ: ${d.preTest.lightBefore||'æ— '} | å¸å¼•å› ç´ : ${d.preTest.attention.join(',')||'æ— '}</p>
                        <p><strong>æµ‹è¯•å:</strong> éš¾æ˜“ç¨‹åº¦: ${d.postTest.ease||'æ— '} | æƒ…æ„ŸæŠ•å…¥: ${d.postTest.engaged==='yes'?'æ˜¯':'å¦'}</p>
                        <p><strong>æ€»é”™è¯¯æ•°:</strong> ${d.tasks.reduce((s,t)=>s+t.error,0)} | <strong>æ€»å®Œæˆæ—¶é—´:</strong> ${d.tasks.reduce((s,t)=>s+(parseFloat(t.time)||0),0).toFixed(1)}</p>
                    </div>
                `).join('');
            }else{
                document.getElementById('avg-time').textContent='0';
                document.getElementById('avg-error').textContent='0';
                document.getElementById('engaged-rate').textContent='0%';
                listContainer.innerHTML='<div class="alert">æš‚æ— æµ‹è¯•æ•°æ®ï¼Œè¯·å…ˆå¡«å†™å¹¶ä¿å­˜æµ‹è¯•è¡¨å•ã€‚</div>';
            }
        }

        function clearAllData(){
            if(confirm('ç¡®å®šè¦æ¸…ç©ºæ‰€æœ‰æ•°æ®å—ï¼Ÿæ­¤æ“ä½œä¸å¯æ¢å¤ï¼')){
                localStorage.removeItem('testingData');
                updateSummary();
                alert('æ‰€æœ‰æ•°æ®å·²æ¸…ç©ºï¼');
            }
        }

        function exportData(){
            const allData=localStorage.getItem('testingData');
            if(!allData||allData==='[]'){alert('æ²¡æœ‰æ•°æ®å¯å¯¼å‡ºï¼');return;}
            
            const blob=new Blob([allData],{type:'application/json'});
            const url=URL.createObjectURL(blob);
            const a=document.createElement('a');
            a.href=url;
            a.download='testing-data-'+new Date().toISOString().split('T')[0]+'.json';
            a.click();
            URL.revokeObjectURL(url);
        }

        updateSummary();
    </script>
</body>
</html>
